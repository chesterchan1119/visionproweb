<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MediaPipe Pose Estimation</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    
    <link rel="stylesheet" type="text/css" href="../statics/index.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='../statics/index.css') }}">
</head>

<body>
    <nav class="navMenu" id="navbar" >
        <h4 href="/">MediaPipe Pose Estimation</h4>
        <a href="/" id="MediaPipe">MediaPipe</a>
        <a href="/movenet" id="">Movenet</a>
        <a href="/posenet" id="">OpenPose</a>
        <a href="/upload" id="">Upload Video</a>
    
    
       
        <div style="margin-left:auto;" >
            <a > <i style= "transform: translateY(-5px);" class="fas fa-adjust fa-lg"></i></a>
            <input type="checkbox" id="darkModeToggle" class="light-switch">
            <label for="darkModeToggle" class="light-switch-label">
              <span class="light-switch-inner"></span>
              <span class="light-switch-slider"></span>
            </label>
       </div>
      
       <script>
        const darkModeToggle = document.getElementById('darkModeToggle');
        const body = document.body;
      

        const isDarkMode = localStorage.getItem('darkMode');
      
      
        if (isDarkMode === 'true') {
          darkModeToggle.checked = true;
          body.classList.add('dark-mode');
        }
      
        darkModeToggle.addEventListener('change', () => {
          if (darkModeToggle.checked) {
            body.classList.add('dark-mode');
            localStorage.setItem('darkMode', 'true');
          } else {
            body.classList.remove('dark-mode');
            localStorage.setItem('darkMode', 'false');
          }
        });
      </script>
    </nav>
<br>

<!-- <form id="videoForm" action="/" method="get" enctype="multipart/form-data">
  <div class="input-group mb-3">
    <div class="col-auto">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="api" value="curl" id="mediapipeRadio" onclick="storeSelectedAPI('curl')">
        <label class="form-check-label" for="mediapipeRadio">Curl</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="api" value="row" id="movenetRadio" onclick="storeSelectedAPI('row')">
        <label class="form-check-label" for="movenetRadio">Row</label>
      </div>
    </div>
  </div>
</form> -->

<!-- HTML -->
<div class="">
<button type="button" class="btn btn-primary" id="curlBtn" onclick="callApiForCurl()">Bicep Curl</button> 
<button type="button" class="btn btn-primary" id="rowBtn" onclick="callApiForRow()">Row</button>
</div>
<div id="responseContainer">

    <img id="videoFeed" src="">
</div>
<!-- <div id="videoContainer1" class="video-container" style="width: 1000px; display: none;">
  <img id="videoFeed1" src="{{ url_for('video_feed_for_curl')}}">
</div>
<div id="videoContainer2" class="video-container" style="width: 1000px; display: none;">
  <img id="videoFeed2" src="{{ url_for('video_feed_for_row')}}">
</div> -->

<script>
// JavaScript
function callApiForCurl() {
  fetch('/video_feed_for_curl')
    .then(response => {
      const videoFeed = document.getElementById('videoFeed');
      videoFeed.src = response.url;  // 將API回應的URL設置為影片流的src屬性
    })
    .catch(error => {
      console.error(error);
    });
}

function callApiForRow() {
  fetch('/video_feed_for_row')
    .then(response => {
      const videoFeed = document.getElementById('videoFeed');
      videoFeed.src = response.url;  // 將API回應的URL設置為影片流的src屬性
    })
    .catch(error => {
      console.error(error);
    });
}

</script>

<!-- <script>
  function storeSelectedAPI(api) {
    sessionStorage.setItem('selected_api', api);
    refreshVideoContainer();
  }

  function refreshVideoContainer() {
    var selectedAPI = sessionStorage.getItem('selected_api');
    if (selectedAPI) {
      var videoContainer = document.getElementById('videoContainer1');
      var videoFeed = document.getElementById('videoFeed1');

      // Set the correct API endpoint based on the selected API
      var apiEndpoint = selectedAPI === 'curl' ? '/video_feed_for_curl' : '/video_feed_for_row';

      // Fetch the updated video feed URL
      fetch(apiEndpoint)
        .then(response => {
          if (response.ok) {
            return response.text();
          } else {
            throw new Error('Network response was not ok');
          }
        })
        .then(data => {
          // Update the video feed src
          videoFeed.src = data;

          // Show the video container
          videoContainer.style.display = 'block';
        })
        .catch(error => {
          console.error('Error:', error);
        });
    }
  }
  
  // Refresh the video container on page load
  refreshVideoContainer();
</script> -->

<!-- <script>
  function storeSelectedAPI(api) {
    sessionStorage.setItem('selected_api', api);
  }

  // Check if there is a selected API in the session storage
  var selectedAPI = sessionStorage.getItem('selected_api');
  if (selectedAPI) {
    // Show the corresponding video container based on the selected API
    var selectedContainer = document.getElementById(`videoContainer${selectedAPI === 'curl' ? '1' : '2'}`);
    selectedContainer.style.display = 'block';
  }
</script> -->

<br>

<br><br>
<div class = "container"></div>
<table class="table mt-5">
    <thead>
        <tr>
            <th>Metrics</th>
            <th>Value</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Percentage of Correct Parts (PCP)</td>
            <td>{{ pcp_value }}</td>
        </tr>
        <tr>
            <td>Percentage of Correct Key-points (PCK)</td>
            <td>{{ pck_value }}</td>
        </tr>
        <tr>
            <td>Percentage of Detected Joints (PDJ)</td>
            <td>{{ pdj_value }}</td>
        </tr>
        <tr>
            <td>Object Keypoint Similarity (OKS) based mAP</td>
            <td>{{ oks_map_value }}</td>
        </tr>
    </tbody>
</table>

</body>
</html>